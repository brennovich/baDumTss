/*! Ba Dum Tss - v0.1.0 - 2013-08-25
* https://github.com/brennovich/ba_dum_tss/
* Copyright (c) 2013 Brenno Costa; Licensed MIT */!function(){jQuery(function(){return $.baDumTss=function(a,b){var c;return c="",this.settings={},this.$element=$(a),this.callback=function(a,b){return null==b&&(b=[]),this.settings[a].apply(this,b)},this.setState=function(a){return c=a},this.getState=function(){return c},this.init=function(){return this.settings=$.extend({},this.defaults,b),this.settings.spinConfig.top=.4*this.settings.expanderHeight,this.$imageList=this.$element.find(this.settings.listSelector),this.bindImageAnchorEvents(),this.setState("ready")},this.bindImageAnchorEvents=function(){var a=this;return this.$imageList.children("a").on("click",function(b){return b.preventDefault(),a.appendExpander($(b.currentTarget))})},this.appendExpander=function(a){var b,c,d,e;return d=a.parent(),c=d.children(".expander"),b=this.$imageList.find(".expander"),d.addClass("active"),b.length?(d.hasClass("active")&&!b.is(c)&&(e=this.buildExpander),this.removeExpander(b,e,[d,a])):this.buildExpander(d,a)},this.expanderMarkup=function(){return $("<div>",{"class":"expander",html:$("<div>",{"class":"expander-container"})})},this.containerContentMarkup=function(a){return $("<figure>",{html:$("<img>",{src:a.prop("href")})})[0].outerHTML+$("<div>",{"class":"details"})[0].outerHTML+$("<a>",{"class":"close",href:"#",text:"X"})[0].outerHTML+$("<a>",{"class":"prev",href:"#",text:"<"})[0].outerHTML+$("<a>",{"class":"next",href:"#",text:">"})[0].outerHTML},this.buildExpander=function(a,b){var c,d,e,f=this;return a.append(this.expanderMarkup()),a.find(".expander .expander-container").append(this.containerContentMarkup(b)),this.bindCloseAction(a),this.bindNavigation(a),d=a.children(".expander"),c=d.find(".details"),e=d.find("img"),d.height(this.settings.expanderHeight),a.height(this.settings.expanderHeight+a.height()),e.height(d.find("figure").height),d.spin(this.settings.spinConfig),e.load(function(){return c.append($("<h3>",{html:b.children("img").prop("title")})).append($("<p>",{html:b.children("img").data("description")})),c.css("opacity",1),e.css("opacity",1),d.spin(!1),f.focusToEl(a)})},this.focusToEl=function(a){var b,c,d;return d=$(window).height()-$(window).height()-2,b=a.offset().top+this.settings.scrollOffset,c=b+d,0>d&&c>Math.abs(d)&&(b=c),$("html, body").animate({scrollTop:b},"fast")},this.removeExpander=function(a,b,c){var d,e=this;return null==c&&(c=[]),d=function(){return a.parent().height("auto"),a.remove(),b?b.apply(e,c):void 0},a.parent().removeClass("active"),a.html(""),a.css({height:0,opacity:0}),a.length?d():void 0},this.bindCloseAction=function(a){return a.find("a.close").click(function(b){return b.preventDefault(),a.children("a").trigger("click")})},this.bindNavigation=function(a){var b=this;return a.find("a.prev").click(function(c){var d;return c.preventDefault(),d=a.prev("li").children("a"),d.trigger("click"),d.length?void 0:b.$imageList.last().children("a").trigger("click")}),a.find("a.next").click(function(c){var d;return c.preventDefault(),d=a.next("li").children("a"),d.trigger("click"),d.length?void 0:b.$imageList.first().children("a").trigger("click")})},this.init(),this},$.baDumTss.prototype.defaults={listSelector:"ul li",scrollOffset:120,expanderHeight:350,spinConfig:{lines:9,length:0,width:12,radius:17,corners:1,rotate:24,direction:1,color:"#454545",speed:.8,trail:62,shadow:!1,hwaccel:!0,className:"spinner",zIndex:2e9,left:"auto"}},$.fn.baDumTss=function(a){return this.each(function(){var b;return void 0===$(this).data("baDumTss")?(b=new $.baDumTss(this,a),$(this).data("baDumTss",b)):void 0})}})}.call(this);